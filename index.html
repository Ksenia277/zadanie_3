<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.18/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
    <script defer src="/src/main.js"></script>
    <link rel="stylesheet" href="src/assets/main.css">
    <title>Kanban доска</title>
</head>
<body>
<div id="app">
    <div class="grid-container">
        <div class="column" v-for="(column, index) in columns" :key="index">
            <button v-if="index === 0" @click="addTask(column)">Создать</button>
            <h3>{{ column.title }}</h3>
            <div class="task-list" :options="{ group: 'tasks' }">
                <transition-group>
                    <div v-for="(task, taskIndex) in column.tasks" :key="task.id" class="task-card">
                        <div class="task-actions" v-if="isEditingTask(task) || isFirstTask(taskIndex, column.tasks)">
                            <button @click="removeTask(task, column)">Удалить</button>
                        </div>
                        <input v-model="task.title" type="text" class="task-title" v-if="isEditingTask(task)">
                        <p class="task-title" v-else>{{ task.title }}</p>
                        <textarea v-model="task.description" class="task-description"></textarea>
                        <input v-model="task.deadline" type="datetime-local" class="task-deadline" @input="checkDeadline(task)">
                        <button v-if="column.title === 'Запланированные задачи'" @click="moveToInProgress(column)">Перенести в "Задачи в работе"</button>
                        <p>Дата редактирования: {{ task.lastChange}}</p>
                        <p>Дата создания: {{ task.createdAt | formatDate }}</p>


                        <div class="task-card-col-4" :class="{ overdue: task.overdue }">
                            <input v-if="task.isEditing" v-model="task.deadline" type="date" class="task-deadline" @input="checkDeadline(task)">
                            <div v-if="column.title === 'Выполненные задачи'" class="task-overdue">
                                <p v-if="task.isOverdue">Просрочено</p>
                                <p v-else>Сдано в срок</p>
                            </div>
                            <div v-if="column.title === 'Выполненные задачи'" v-else class="task-completed">

                            </div>
                        </div>
                        <p v-if="returnReason" >{{ task.returnReason }}</p>
                    </div>

                </transition-group>
            </div>
            <button v-if="column.title === 'Задачи в работе'" @click="moveToTesting(column)">Перенести в "Тестирование"</button>
            <button v-if="column.title === 'Тестирование'" @click="moveToCompletedtasks(column)">Перенести в "Выполненные задачи"</button>
            <button v-if="column.title === 'Тестирование'" @click="moveToWork(column, returnReason)">Обратно в "Задачи в работе"</button>
            <input type="text" v-model="returnReason" placeholder="Reason for returning to work" class="return-reason" v-if="column.title === 'Тестирование'">
        </div>
    </div>
</div>
<script defer src="./js/main.js"></script>

</body>
</html>